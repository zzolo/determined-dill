"use strict";!function(){var t=window.pickleJumper=window.pickleJumper||{};t.states=t.states||{},t.states.Gameover=function(){Phaser.State.call(this),this.padding=10},t.states.Gameover.prototype=Object.create(Phaser.State.prototype),t.states.Gameover.prototype.constructor=t.states.Gameover,_.extend(t.states.Gameover.prototype,Phaser.State.prototype,{preload:function(){this.game.load.image("gameover","assets/gameover.png"),this.game.load.image("play","assets/title-play.png")},create:function(){this.game.stage.backgroundColor="#8cc63f",this.titleImage=this.game.add.sprite(this.game.width/2,3*this.padding,"gameover"),this.titleImage.anchor.setTo(.5,0),this.titleImage.scale.setTo((this.game.width-8*this.padding)/this.titleImage.width),this.game.add.existing(this.titleImage),this.score=this.game.pickle.score,this.game.pickle.isHighscore(this.score)&&this.highscoreInput(),this.game.pickle.isHighestScore(this.score)&&console.log("highest"),this.highscoreList(),this.replayImage=this.game.add.sprite(this.game.width-2*this.padding,this.game.height-2*this.padding,"play"),this.replayImage.anchor.setTo(1,1),this.replayImage.scale.setTo(.25*this.game.width/this.replayImage.width),this.game.add.existing(this.replayImage),this.replayImage.inputEnabled=!0,this.replayImage.events.onInputOver.add(function(){this.replayImage.originalTint=this.replayImage.tint,this.replayImage.tint=8388607.5},this),this.replayImage.events.onInputOut.add(function(){this.replayImage.tint=this.replayImage.originalTint},this),this.replayImage.events.onInputDown.add(this.replay,this),this.leftButton=this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT),this.rightButton=this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),this.upButton=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),this.downButton=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN),this.actionButton=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.leftButton.onDown.add(function(){this.hInput&&this.moveCursor(-1)},this),this.rightButton.onDown.add(function(){this.hInput&&this.moveCursor(1)},this),this.upButton.onDown.add(function(){this.hInput&&this.moveLetter(1)},this),this.downButton.onDown.add(function(){this.hInput&&this.moveLetter(-1)},this),this.actionButton.onDown.add(function(){this.hInput?this.saveHighscore():this.replay()},this)},update:function(){},shutdown:function(){["titleText","replayText"].forEach(_.bind(function(t){this[t]&&this[t].destroy&&(this[t].destroy(),this[t]=null)},this))},replay:function(){this.game.state.start("play")},highestScore:function(){this.highestScoreText=this.game.add.text(.5*this.game.world.width,.25*this.game.world.height,"You got the\nhighest score!!",{font:"bold "+this.game.world.height/15+"px Arial",fill:"#fff",align:"center"}),this.highestScoreText.anchor.set(.5)},highscoreInput:function(){this.hInput=!0,this.hInputIndex=0,this.hInputs=this.game.add.group();var t=new Phaser.Text(this.game,.33333*this.game.world.width,.5*this.game.world.height,"A",{font:"bold "+this.game.world.height/15+"px Arial",fill:"#FFFFFF",align:"center"});t.anchor.set(.5),this.hInputs.add(t);var e=new Phaser.Text(this.game,.5*this.game.world.width,.5*this.game.world.height,"A",{font:"bold "+this.game.world.height/15+"px Arial",fill:"#FFFFFF",align:"center"});e.anchor.set(.5),this.hInputs.add(e);var i=new Phaser.Text(this.game,.66666*this.game.world.width,.5*this.game.world.height,"A",{font:"bold "+this.game.world.height/15+"px Arial",fill:"#FFFFFF",align:"center"});i.anchor.set(.5),this.hInputs.add(i),this.hCursor=this.game.add.text(t.x,t.y-this.game.world.height/20,"_",{font:"bold "+this.game.world.height/5+"px Arial",fill:"#FFFFFF",align:"center"}),this.hCursor.anchor.set(.5),this.moveCursor(0)},moveCursor:function(t){var e=this.hInputIndex+t;this.hInputIndex=0>e?this.hInputs.length-1:e>=this.hInputs.length?0:e;var i=this.hInputs.getChildAt(this.hInputIndex);this.hCursor.x=i.x,this.hInputs.forEach(function(t){t.fill="#FFFFFF"}),i.fill="#FFDDBB"},moveLetter:function(t){var e=this.hInputs.getChildAt(this.hInputIndex),i=e.text,h="A"===i&&-1===t?"Z":"Z"===i&&1===t?"A":String.fromCharCode(i.charCodeAt(0)+t);e.text=h},saveHighscore:function(){var t="";this.hInputs.forEach(function(e){t+=e.text}),"AAA"!==t&&(this.game.pickle.setHighscore(this.score,t),this.hInput=!1,this.hInputs.destroy(),this.hCursor.destroy())},highscoreList:function(){this.game.pickle.highscores.length>0&&console.log(this.game.pickle.highscores)}})}();
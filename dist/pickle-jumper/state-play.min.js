"use strict";!function(){var t=window.pickleJumper=window.pickleJumper||{};t.states=t.states||{},t.states.Play=function(){Phaser.State.call(this)},t.states.Play.prototype=Object.create(Phaser.State.prototype),t.states.Play.prototype.constructor=t.states.Game,_.extend(t.states.Play.prototype,Phaser.State.prototype,{preload:function(){this.game.load.atlas("game-sprites","/assets/pickle-jumper-sprites.png","/assets/pickle-jumper-sprites.json")},create:function(){this.game.stage.backgroundColor="#33CCFF",this.platformSpaceY=110,this.platformGapMax=200,this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.maxWidth=this.game.width,this.game.scale.maxHeight=this.game.height,this.game.scale.pageAlignHorizontally=!0,this.game.scale.pageAlignVertically=!0,this.cameraYMin=9999999,this.platformYMin=9999999,this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.gravity.y=1e3,this.startY=this.game.height-50,this.hero=new t.prefabs.Hero(this.game,.5*this.game.width,this.startY-50),this.game.add.existing(this.hero),this.addPlatforms(),this.cursors=this.game.input.keyboard.createCursorKeys(),this.actionButton=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)},update:function(){this.world.setBounds(0,-this.hero.yChange,this.game.world.width,this.game.height+this.hero.yChange),this.cameraYMin=Math.min(this.cameraYMin,this.hero.y-this.game.height/2),this.camera.y=this.cameraYMin,this.hero.y>this.cameraYMin+this.game.height+200&&this.gameOver(),this.hero.body.velocity.x=this.cursors.left.isDown?-(this.game.physics.arcade.gravity.y/5):this.cursors.right.isDown?this.game.physics.arcade.gravity.y/5:0,this.game.physics.arcade.collide(this.hero,this.platforms),this.platforms.forEachAlive(function(t){var s;this.platformYMin=Math.min(this.platformYMin,t.y),t.y>this.camera.y+this.game.height&&(t.kill(),s=this.platforms.getFirstDead(),this.placePlatform(this.platforms.getFirstDead(),this.platforms.getTop()))},this)},gameOver:function(){console.log("gameover")},addPlatforms:function(){this.platforms=this.game.add.group();var s=new t.prefabs.Platform(this.game,.5*this.game.width,this.startY);this.platforms.add(s);var a;_.each(_.range(20),_.bind(function(s){var e=new t.prefabs.Platform(this.game,0,0);this.placePlatform(e,a,this.world.height-this.platformSpaceY-this.platformSpaceY*s),this.platforms.add(e),a=e},this))},placePlatform:function(t,s,a){var e=a||this.platformYMin-this.platformSpaceY,i=t.width/2+10,h=this.world.width-i,r=this.rnd.integerInRange(i,h);s&&(r=this.rnd.integerInRange(s.x-this.platformGapMax,s.x+this.platformGapMax),r=0>r?Math.min(h,this.world.width+r):Math.max(r,i),r=r>this.world.width?Math.max(i,r-this.world.width):Math.min(r,h)),t.reset(r,e)},updateScore:function(t){this.score=this.score||0,this.score=this.score+t,this.scoreText||(this.scoreText=this.game.add.text(.5*this.game.world.width,20,"Score: "+this.score,{font:"bold "+this.game.world.height/25+"px Arial",fill:"#fff",align:"center"}),this.scoreText.anchor.set(.5))}})}();